<!doctype html>
<html lang="en">
	<head>
		<title>Face tracker</title>
		<meta charset="utf-8">
		<link rel="stylesheet" href="./styles/index.css">
		<link href="./styles/bootstrap.min.css" rel="stylesheet" type="text/css">

		<!-- Preloader JavaScript -->
		<script>
			// getUserMedia only works over https in Chrome 47+, so we redirect to https. Also notify user if running from file.
			if (window.location.protocol == "file:") {
				alert("You seem to be running this example directly from a file. Note that these examples only work when served from a server or localhost due to canvas cross-domain restrictions.");
			} else if (window.location.hostname !== "localhost" && window.location.protocol !== "https:"){
				window.location.protocol = "https";
			}
		</script>
		<script type="text/javascript" src="js/pre.js"></script>
	</head>

	<body>
		<script src="./js/libs/dat.gui.min.js"></script>
		<script src="./js/libs/utils.js"></script>
		<script src="./js/libs/webgl-utils.js"></script>
		<script src="./build/clmtrackr.js"></script>
		<script src="./models/model_pca_20_svm.js"></script>
		<script src="./js/libs/Stats.js"></script>
		<script src="./js/face_deformer.js"></script>
		<script src="./js/libs/jquery.min.js"></script>
		<script src="./js/libs/poisson_new.js"></script>
		
		<div id="content">
			<!-- <h2>Facetracking example</h2> -->
			<div id="container">
				<video id="videoel" width="800" height="600" preload="auto" style="visibility:hidden" loop playsinline autoplay>
				</video>
				<canvas id="overlay" width="800" height="600" style="display:none"></canvas>
				<canvas id="webgl" width="800" height="600"></canvas>
			</div>
			<br/>
			<div id="controls">
				<input class="btn" type="button" value="wait, loading video & images" disabled="disabled" onclick="startVideo()" id="startbutton"></input>
				<select name="mask" id="selectmask">
					<option value="0">Average face</option>
					<option value="1">Terminator</option>
					<option value="2">Walter</option>
					<option value="3">Clooney</option>
					<option value="4">Bieber</option>
					<option value="5">Kim</option>
					<option value="6">Rihanna</option>
					<option value="7">Audrey Hepburn</option>
					<option value="8">Bill Murray</option>
					<option value="9">Sean Connery</option>
					<option value="10">Cage</option>
					<option value="11">The Queen</option>
					<option value="12">Obama</option>
					<option value="13">Chuck Norris</option>
					<option value="14">Mona Lisa</option>
					<option value="15">Picasso</option>
					<option value="16">Abstract (Scream)</option>
				</select>
			</div>
			<input class="btn" type="button" value="wait, loading video" disabled="disabled" onclick="startVideo()" id="startbutton" style="margin-top:80vh;"></input>
			
			<canvas id="webgl2" width="800" height="600"></canvas>
			

			<!-- Pre Config 01 -->
			<script>
				var images = [
					{"id":"average", 	"path":"./media/average2_crop.jpg"},
					{"id":"terminator", "path":"./media/terminator_crop.jpg"},
					{"id":"walter2", 	"path":"./media/walter2_crop.jpg"},
					{"id":"clooney2", 	"path":"./media/fragrance-George-Clooney-main_crop.jpg"},
					{"id":"bieber", 	"path":"./media/Justin-Bieber2_crop.jpg"},
					{"id":"kim", 		"path":"./media/kim1_crop.jpg"},
					{"id":"rihanna", 	"path":"./media/ri_1_crop.jpg"},
					{"id":"audrey", 	"path":"./media/audrey_crop.jpg"},
					{"id":"bill", 		"path":"./media/bill-murray-snl_crop.jpg"},
					{"id":"connery2", 	"path":"./media/sean_guru2_crop.jpg"},
					{"id":"cage3", 		"path":"./media/cage2_crop.jpg"},
					{"id":"queen", 		"path":"./media/queen20_crop.jpg"},
					{"id":"obama4", 	"path":"./media/obama4_crop.jpg"},
					{"id":"chuck", 		"path":"./media/chuck_crop.jpg"},
					{"id":"monalisa", 	"path":"./media/joconde_crop.jpg"},
					{"id":"picasso1", 	"path":"./media/picasso_drawing_crop.jpg"},
					{"id":"scream", 	"path":"./media/scream_crop.jpg"}
				];

				// when everything is ready, automatically start everything ?

				var vid = document.getElementById('videoel');
				var vid_width = vid.width;
				var vid_height = vid.height;
				var overlay = document.getElementById('overlay');
				var overlayCC = overlay.getContext('2d');
				var webgl_overlay = document.getElementById('webgl');
				var webgl_overlay2 = document.getElementById('webgl2');

				// canvas for copying the warped face to
				var newcanvas = document.createElement('CANVAS');
				newcanvas.width = vid_width;
				newcanvas.height = vid_height;
				// canvas for copying videoframes to
				var videocanvas = document.createElement('CANVAS');
				videocanvas.width = vid_width;
				videocanvas.height = vid_height;
				// canvas for masking
				var maskcanvas = document.createElement('CANVAS');
				maskcanvas.width = vid_width;
				maskcanvas.height = vid_height;
			</script>

			<!-- *********** Setup of video/webcam and checking for webGL support *********/ -->
			<script src="./js/webGL_config.js"></script>

			<!-- *********** Code for face tracking *********/ -->
			<script src="./js/facetracking.js"></script>

		</div>
	</body>
</html>
